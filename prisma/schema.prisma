datasource db {
    provider = "postgresql"
    url      = "postgresql://jayden@localhost:5432/production"
}

generator client {
    provider = "cargo prisma"
    output   = "./server/src/prisma.rs"
}

model User {
    id        String   @id @default(uuid())
    username  String   @unique
    password  String
    createdAt DateTime @default(now())

    memberships GuildMembership[]
    messages    Message[]

}

model Guild {
    id        String   @id @default(uuid())
    name      String
    createdAt DateTime

    members  GuildMembership[]
    channels Channel[]
}

model GuildMembership {
    user    User   @relation(fields: [userId], references: [id])
    guild   Guild  @relation(fields: [guildId], references: [id])
    userId  String
    guildId String

    nickname String?

    @@id([userId, guildId])
}

model Channel {
    id String @id @default(uuid())

    messages Message[]
    guild    Guild     @relation(fields: [guildId], references: [id])
    guildId  String
}

model Message {
    id      String @id @default(uuid())
    content String

    author    User    @relation(fields: [authorId], references: [id])
    channel   Channel @relation(fields: [channelId], references: [id])
    authorId  String
    channelId String
}
